<!DOCTYPE html>
<html>
<head>
    <title>Choisissez votre navigateur</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 50px;
        }
        .button {
            display: inline-block;
            padding: 10px 20px;
            margin: 10px;
            color: white;
            background-color: #007bff;
            text-decoration: none;
            border-radius: 5px;
        }
        .button-secondary {
            background-color: #6c757d;
        }
    </style>
    <script>
        function detectChrome() {
            var userAgent = navigator.userAgent || navigator.vendor || window.opera;
            var isIOS = /iPad|iPhone|iPod/.test(userAgent) && !window.MSStream;

            if (isIOS) {
                var now = Date.now();
                var chromeInstalled = false;
                var chromeQuery = 'googlechrome://';
                var appStoreURL = 'https://apps.apple.com/us/app/google-chrome/id535886823';

                // Crée un iframe caché pour tenter d'ouvrir Chrome
                var iframe = document.createElement('iframe');
                iframe.style.display = 'none';
                document.body.appendChild(iframe);

                // Événements de détection
                window.addEventListener('blur', function () {
                    chromeInstalled = true;
                    document.getElementById('chromeButton').innerHTML = "Répondre avec Google Chrome";
                });

                window.addEventListener('focus', function () {
                    if (!chromeInstalled && Date.now() - now < 2000) {
                        document.getElementById('chromeButton').innerHTML = "Installer Google Chrome";
                    }
                });

                // Si le retour est rapide, on considère que Chrome n'est pas installé
                setTimeout(function () {
                    if (!chromeInstalled && Date.now() - now < 1500) {
                        document.getElementById('chromeButton').innerHTML = "Installer Google Chrome";
                    }
                    document.body.removeChild(iframe);
                }, 1000);

                iframe.src = chromeQuery;
            } else {
                document.getElementById('chromeButton').style.display = "none";
            }
        }

        function openChrome() {
            var chromeQuery = 'googlechrome://g.page/r/CcN_-2m8sPZ0EB0/review';
            var appStoreURL = 'https://apps.apple.com/us/app/google-chrome/id535886823';
            var buttonText = document.getElementById('chromeButton').innerHTML;

            if (buttonText === "Répondre avec Google Chrome") {
                window.location = chromeQuery;
            } else {
                window.location = appStoreURL;
            }
        }

        window.onload = detectChrome;
    </script>
</head>
<body>
    <h1>Choisissez votre navigateur</h1>
    <p>Pour une meilleure expérience, nous vous recommandons d'utiliser Google Chrome.</p>
    <a id="chromeButton" class="button" href="#" onclick="openChrome()">Vérification...</a>
    <a href="https://g.page/r/CcN_-2m8sPZ0EB0/review" class="button button-secondary">Répondre avec Safari</a>
</body>
</html>
